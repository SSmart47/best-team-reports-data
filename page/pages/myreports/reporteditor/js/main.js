const firebaseConfig={apiKey:"AIzaSyAqCTjwhTzgLUV_HrGLhdxjxx5nFR4g0Sg",authDomain:"betsteamreportsdata.firebaseapp.com",databaseURL:"https://betsteamreportsdata-default-rtdb.firebaseio.com",projectId:"betsteamreportsdata",storageBucket:"betsteamreportsdata.appspot.com",messagingSenderId:"507208715373",appId:"1:507208715373:web:2f6188e8252c868f8a0364"};firebase.initializeApp(firebaseConfig);var s_time='<input type="time" class="css-inp-time" value="#" id="@">',s_num='<input type="number" class="css-inp-num" value="#" id="@">',s_speed='<div class="input-group"><input type="number" class="css-inp-num-gp" value="#" id="@"><span class="css-btw">/</span><input type="time" class="css-inp-time-gp" value="$" id="@"></div>',def_time=Changed(s_time,"#","00:00"),def_num=Changed(s_num,"#","0"),def_speed=ChangedTwo(s_speed,"#","0","$","00:00"),DefaultCodeOf={num:def_num,time:def_time,speed:def_speed},username=localStorage.getItem("ss47_bestteamreportsdata_user_i"),_u_n_=localStorage.getItem("ss47_bestteamreportsdata_user_n"),cur_date=localStorage.getItem("ss47_bestteamreportsdata_user_d"),mol=[],mtl=[];function Changed(e,t,r){for(var a="",n=0;n<e.length;n++)e[n]==t?a+=r:a+=e[n];return a}function SetID(e,t,r){for(var a="",n=0,s=0;s<e.length;s++)e[s]==t?(a+=r[n],n++):a+=e[s];return a}function ChangedTwo(e,t,r,a,n){for(var s="",o=0;o<e.length;o++)e[o]==a?s+=n:e[o]==t?s+=r:s+=e[o];return s}function JsonToList(e){var t,r=e,a=[];for(t in r)a.push([t,r[t]]);return a}document.getElementById("id_cur_date").innerHTML=cur_date;async function UserObjectList(e){var t=[];return await firebase.database().ref().child("users").child(username).child("reports").child(e).get().then(e=>{e.exists()?(e=e.val(),t=JsonToList(e)):console.log("No Report Found!")}).catch(e=>{alert("No connection to server!"),console.error(e)}),t}function Part(e,t){for(var r="",a="",n=0,s=0;s<e.length;s++)"-"==e[s]?n++:0==n?r+=e[s]:a+=e[s];return 1==t?r:a}function ToHour(e){var t=parseInt(e),r=parseInt(t/60),a="",e="";return e+=t%=60,(a+=r).length<2&&(a="0"+a),e.length<2&&(e="0"+e),a+":"+e}UpdateList();async function UpdateList(){var c=await UserObjectList(cur_date);c.length<1||firebase.database().ref().child("objects").get().then(e=>{if(e.exists()){mol=[],mtl=[];for(var t=document.getElementById("id_list_1"),r=JsonToList(e.val()),a="",n=0;n<r.length;n++){var s=r[n][0],o=r[n][1].type;mtl.push(o),mol.push(s),a+='<tr><th scope="row">'+(n+1)+"</th>",a+="<td>"+s+"</td>";for(var d=!1,i=0;i<c.length;i++)if(c[i][0]==s){var u=c[i][1].value,l="";"num"==o?l=Changed(s_num,"#",u):"time"==o?l=Changed(s_time,"#",ToHour(u)):"speed"==o&&(l=ChangedTwo(s_speed,"#",Part(u,1),"$",ToHour(Part(u,2))));var _="",m=1;_+=m+=n,a+="<td>"+(l=SetID(l,"@","speed"==o?["id_row_"+_+"_speed_1","id_row_"+_+"_speed_2"]:["id_row_"+_+"_"+o]))+"</td>",d=!0;break}d||(_="",m=1,_+=m+=n,a+="<td>"+(l=SetID(l=DefaultCodeOf[o],"@","speed"==o?["id_row_"+_+"_speed_1","id_row_"+_+"_speed_2"]:["id_row_"+_+"_"+o]))+"</td>"),a+="</tr>"}t.innerHTML=a}else console.log("No Report!"),document.getElementById("id_list_1").innerHTML=""}).catch(e=>{alert("No Connection!"),console.error(e)})}function SubStr(e,t,r){var a="";t<0&&(t=0),r>e.length&&(r=e.length);for(var n=t;n<r;n++)a+=e[n];return a}function ToMinute(e){var t=SubStr(e,0,2),e=SubStr(e,3,5),t=parseInt(t);return t*=60,t+=parseInt(e)}document.getElementById("id_btn_back").onclick=function(){localStorage.setItem("ss47_bestteamreportsdata_user_i",username),localStorage.setItem("ss47_bestteamreportsdata_user_n",_u_n_),localStorage.setItem("ss47_bestteamreportsdata_user_d",""),window.location="../myreports.html"},document.getElementById("id_btn_save").onclick=function(){if(!(mol.length<1)){for(var e=0;e<mol.length;e++){var t=mtl[e],r=mol[e],a="",n="",s=1;if(n+=s+=e,"num"==t){if(a+=document.getElementById("id_row_"+n+"_num").value,parseFloat(a)<0)return void alert("Number should not be smaller than zero!")}else if("time"!=t&&(a+=document.getElementById("id_row_"+n+"_speed_1").value,parseFloat(a)<0))return void alert("Number should not be smaller than zero!")}for(e=0;e<mol.length;e++){t=mtl[e],r=mol[e],a="",n="",s=1;n+=s+=e,a+="num"==t?document.getElementById("id_row_"+n+"_num").value:"time"==t?ToMinute(document.getElementById("id_row_"+n+"_time").value):document.getElementById("id_row_"+n+"_speed_1").value+"-"+ToMinute(document.getElementById("id_row_"+n+"_speed_2").value),firebase.database().ref("users/"+username+"/reports/"+cur_date+"/"+r).set({value:a,type:t})}alert("Сохранено!")}};
